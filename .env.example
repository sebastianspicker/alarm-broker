# =============================================================================
# Alarm Broker Configuration
# =============================================================================
# Copy this file to .env and adjust the values for your environment.
# Leave empty values as-is for defaults or to disable features.
# =============================================================================

# -----------------------------------------------------------------------------
# Core Infrastructure
# -----------------------------------------------------------------------------
# PostgreSQL connection URL (async)
DATABASE_URL=postgresql+asyncpg://alarm:change-me@postgres:5432/alarm
# Redis connection URL
REDIS_URL=redis://redis:6379/0
# Public base URL for generating ACK links (must be accessible by responders)
BASE_URL=http://localhost:8080
# Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Yealink Device Configuration
# -----------------------------------------------------------------------------
# Query parameter name for device token (usually "token")
YELK_TOKEN_QUERY_PARAM=token
# IP allowlist for Yealink endpoints (comma-separated CIDRs; empty disables)
YELK_IP_ALLOWLIST=

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
# Maximum alarms per device token per minute (1-1000)
RATE_LIMIT_PER_MINUTE=10

# -----------------------------------------------------------------------------
# Admin Access
# -----------------------------------------------------------------------------
# API key for admin endpoints (REQUIRED for production - set a secure value!)
ADMIN_API_KEY=change-me-admin-key
# Enable OpenAPI docs at /docs and /redoc (default: false for security)
ENABLE_API_DOCS=false

# -----------------------------------------------------------------------------
# Proxy Configuration
# -----------------------------------------------------------------------------
# Trusted proxy CIDRs for X-Forwarded-For header (comma-separated; empty disables)
TRUSTED_PROXY_CIDRS=

# -----------------------------------------------------------------------------
# Zammad Integration (Ticket Management)
# -----------------------------------------------------------------------------
# Zammad instance URL
ZAMMAD_BASE_URL=https://zammad.example.org
# API token (leave empty to disable Zammad integration)
ZAMMAD_API_TOKEN=
# Default group for new tickets
ZAMMAD_GROUP=Emergency Desk
# Priority ID for P0 alarms (check your Zammad instance)
ZAMMAD_PRIORITY_ID_P0=3
# State ID for new tickets (check your Zammad instance)
ZAMMAD_STATE_ID_NEW=1
# Default customer identifier
ZAMMAD_CUSTOMER=guess:alarm-system@your-domain.de

# -----------------------------------------------------------------------------
# SMS Integration (SendXMS or compatible provider)
# -----------------------------------------------------------------------------
# Enable SMS notifications (true/false)
SENDXMS_ENABLED=false
# SMS provider API URL
SENDXMS_BASE_URL=https://api.sendxms.tld
# API key (leave empty to disable)
SENDXMS_API_KEY=
# Sender name/number (max 11 chars)
SENDXMS_FROM=Alarm
# API endpoint path
SENDXMS_SEND_PATH=/send
# API mode (only "json" supported)
SENDXMS_MODE=json

# -----------------------------------------------------------------------------
# Signal Integration (signal-cli-rest-api)
# -----------------------------------------------------------------------------
# Enable Signal notifications (true/false)
SIGNAL_ENABLED=false
# signal-cli-rest-api endpoint URL
SIGNAL_CLI_ENDPOINT=http://signal-cli:8080
# Target group ID (leave empty to disable)
SIGNAL_TARGET_GROUP_ID=
# API endpoint path
SIGNAL_SIGNAL_PATH=/v2/send

# -----------------------------------------------------------------------------
# Webhook Callbacks
# -----------------------------------------------------------------------------
# Enable webhook callbacks for alarm state changes (true/false)
WEBHOOK_ENABLED=false
# Webhook URL to POST state changes
WEBHOOK_URL=
# Secret for HMAC signature (optional, recommended)
WEBHOOK_SECRET=
# Request timeout in seconds (1-60)
WEBHOOK_TIMEOUT_SECONDS=5
# Maximum retry attempts (1-10)
WEBHOOK_MAX_RETRIES=3
# Delay between retries in seconds (1-300)
WEBHOOK_RETRY_DELAY_SECONDS=30

# -----------------------------------------------------------------------------
# Escalation Timing (seconds)
# -----------------------------------------------------------------------------
# Delay before first escalation step (0 to disable)
ESCALATE_T1=60
# Delay before second escalation step (0 to disable)
ESCALATE_T2=180
# Delay before third escalation step (0 to disable)
ESCALATE_T3=300

# -----------------------------------------------------------------------------
# Simulation/Demo Mode
# -----------------------------------------------------------------------------
# Enable simulation mode with mock connectors (no external API calls)
SIMULATION_ENABLED=false
# URL to fetch demo seed data (optional, uses bundled data if empty)
SIMULATION_SEED_URL=
